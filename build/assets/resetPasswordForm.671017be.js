import{u as k,r as x,m as L}from"./index.esm.f5a450f4.js";import{_ as E,a as h,u as m,o as i,c as l,g as e,d as V,b as p,w as g,s as P,z as f,X as _,F as I,x as N,B as c,l as y,t as w,I as b,ag as C,ah as D,ai as S,aj as v}from"./index.19bf4f6c.js";const T={name:"VerifyAccount",setup(){return{v$:k({$autoDirty:!0})}},data(){return{isConfirmPasswordValid:!1,code:"",newPassword:"",confirmNewPassword:"",error:"",success:"",loginLink:"",sendNewCodeLink:"",toggle:"hide",resetLoading:!1,newCodeLoading:!1,newCodeSent:!1,showEmailInput:!1,newCodeError:""}},methods:{chechConfirmPassword(){this.isConfirmPasswordValid=!0,this.newPassword!==this.confirmNewPassword&&(this.error="Passwords do not match.",this.isConfirmPasswordValid=!1)},async activateAccount(){this.resetLoading=!0;const r=await this.v$.$validate();if(this.chechConfirmPassword(),r&&this.isConfirmPasswordValid){let s={code:this.code,newPassword:this.newPassword,error:this.error},d={BASE_URL:"/platform/",MODE:"production",DEV:!1,PROD:!0}.VITE_ROOT_API+"/userdata/resetPasswordForm";h.put(d,s).then(n=>{n.status==200&&(m().isLoggedIn===!0&&m().logout(!0),this.$router.push({name:"Login",params:{toastType:"success",toastMessage:"Password Reset! Please login.",toastPosition:"top-right",toastCSS:"Toastify__toast--create"}}))},n=>{var o=document.getElementById("errorDIV");o.classList.remove("hide"),this.error=n.response.data.error,this.success="",this.sendNewCodeLink=" Send new Code?"}),this.resetLoading=!1}},getNewCodeButtonPressed(){m().isLoggedIn===!0?this.getEmail():this.$router.push("/resetPassword")},async getEmail(){this.newCodeLoading=!0;const r=m().userId;let s={BASE_URL:"/platform/",MODE:"production",DEV:!1,PROD:!0}.VITE_ROOT_API+"/userdata/getUserEmail";try{const d=await h.get(s,{params:{userID:r}});d.status===200?(this.email=d.data.email,this.sendNewCode()):(this.handleError("Error:",error),this.newCodeLoading=!1)}catch(d){this.handleError("Error:",d),this.newCodeLoading=!1}},async sendNewCode(){let r={email:this.email,error:this.error},s={BASE_URL:"/platform/",MODE:"production",DEV:!1,PROD:!0}.VITE_ROOT_API+"/userdata/resetPassword";h.put(s,r).then(d=>{d.status==200&&(this.newCodeLoading=!1,this.newCodeSent=!0)},d=>{this.success="",this.newCodeError=d.response.data.error}),this.newCodeLoading=!1}},validations(){return{newPassword:{required:x,minLengthValue:L(8)}}}},a=r=>(D("data-v-ab484160"),r=r(),S(),r),B={class:""},R={class:"px-10 py-20"},O={class:"p-6 space-y-4 md:space-y-6 sm:p-8"},A={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-10"},U={class:"col-span-4 md:col-span-4"},M={class:"d-flex align-center"},F=a(()=>e("span",{class:"ml-2 font-weight-bold"},"Email Sent!",-1)),G=a(()=>e("label",{for:"email",class:"block"},"Please check your email and input the security code to reset your password.",-1)),j={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-10"},q=a(()=>e("label",{for:"email",class:"block"},"New Password",-1)),z={key:0,class:"text-black"},X={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-10"},H=a(()=>e("label",{for:"email",class:"block"},"Confirm New Password",-1)),J={id:"errorDIV",class:"hide max-w-screen-md mx-auto"},K={class:"errorMessage bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4",role:"alert",style:{"max-width":"80%",margin:"0 auto"}},Q=a(()=>e("p",{class:"mt-2"},[e("a",{class:"font-medium text-primary-600 hover:underline dark:text-blue-500"},' Please confirm the code in your email, or click "Get New Code" below. ')],-1)),W={id:"successDIV",class:"hide grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-10"},Y={class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4",role:"alert"},Z={key:"submitAndBackButtons"},$={class:"mt-2"},ee={class:"inline-block mr-4",key:"getCodeButton"},se=a(()=>e("div",{class:"block text-sm text-gray-500 mb-2"},"Didn't receive a code/Expired code?",-1)),oe={class:"mt-2"},te={class:"d-flex align-center"},re=a(()=>e("span",{class:"ml-2 font-weight-bold"},"New Code Sent!",-1)),de={key:1,class:"text-red-600 mt-2"};function ie(r,s,d,n,o,u){return i(),l("section",B,[e("div",R,[e("div",O,[e("form",{onSubmit:s[6]||(s[6]=V(()=>{},["prevent"])),class:"space-y-4 md:space-y-6",action:"/login",method:"POST"},[e("div",A,[e("div",U,[p(P,{cols:"12"},{default:g(()=>[e("div",M,[p(C,{color:"green darken-1"},{default:g(()=>[y("mdi-email")]),_:1}),F])]),_:1}),G,f(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.code=t),type:"text",name:"secretToken",id:"secretToken",class:"w-1/4 md:w-1/3 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Code"},null,512),[[_,o.code]])])]),e("div",j,[e("div",null,[q,f(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.newPassword=t),type:"password",name:"secretToken",id:"secretToken",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"},null,512),[[_,o.newPassword]]),n.v$.newPassword.$error?(i(),l("span",z,[(i(!0),l(I,null,N(n.v$.newPassword.$errors,t=>(i(),l("p",{class:"text-red-700",key:t.$uid},w(t.$message)+"! ",1))),128))])):c("",!0)])]),e("div",X,[e("div",null,[H,f(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>o.confirmNewPassword=t),type:"Password",name:"secretToken",id:"secretToken",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"},null,512),[[_,o.confirmNewPassword]])])]),e("div",J,[e("div",K,[y(w(o.error)+" ",1),Q])]),e("div",W,[e("div",Y,w(o.success),1)]),e("div",Z,[e("button",{onClick:s[3]||(s[3]=(...t)=>u.activateAccount&&u.activateAccount(...t)),type:"submit",class:"bg-red-700 text-white rounded mr-4"}," Reset Password "),e("button",{onClick:s[4]||(s[4]=t=>r.$router.back()),type:"button",class:"bg-gray-600 text-white rounded border border-black"}," Go Back ")]),e("div",$,[o.resetLoading?(i(),b(v,{key:0,indeterminate:"",color:"red"})):c("",!0)]),e("div",ee,[se,e("button",{onClick:s[5]||(s[5]=(...t)=>u.getNewCodeButtonPressed&&u.getNewCodeButtonPressed(...t)),type:"button",class:"bg-red-700 text-white rounded"}," Get New Code ")]),e("div",oe,[o.newCodeLoading?(i(),b(v,{key:0,indeterminate:"",color:"red"})):c("",!0)]),o.newCodeSent?(i(),b(P,{key:0,cols:"12"},{default:g(()=>[e("div",te,[p(C,{color:"green darken-1"},{default:g(()=>[y("mdi-email")]),_:1}),re])]),_:1})):c("",!0),o.newCodeError?(i(),l("p",de,w(o.newCodeError),1)):c("",!0)],32)])])])}const le=E(T,[["render",ie],["__scopeId","data-v-ab484160"]]);export{le as default};
