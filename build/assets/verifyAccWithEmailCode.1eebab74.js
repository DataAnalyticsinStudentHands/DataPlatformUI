import{_ as V,a as f,i as d,o as C,I as E,w as s,k as b,b as t,s as i,g as h,t as r,r as n,l as c,S as p,v as g,h as _,d as w,e as x}from"./index.19bf4f6c.js";const T={name:"VerifyExisting",props:["id"],data(){return{email:null,code:null,loading:!1,emailRules:[e=>{if(e){if(!/.+@.+/.test(e))return this.$t("Email must be valid")}else return this.$t("Email is required");return!0}],codeRules:[e=>e?!0:this.$t("Code is required")]}},methods:{formSubmit(){!this.code||this.activateAccount()},async activateAccount(){this.loading=!0;let e={email:this.email,code:this.code},o={BASE_URL:"/platform/",MODE:"production",DEV:!1,PROD:!0}.VITE_ROOT_API+"/userdata/verifyExisting";try{(await f.put(o,e)).status===200&&this.$router.push({name:"login",params:{toastType:"success",toastMessage:this.$t("Your account is activated! You may now login."),toastPosition:"top-right",toastCSS:"Toastify__toast--create"}})}catch(a){if(console.log("err: ",a.message),a.response.data.title==="Invalid"&&d.error(this.$t("Invalid Email or Code."),{position:"top-right",toastClassName:"Toastify__toast--delete"}),a.response.data.title==="Expired")try{await this.sendNewCode()}catch{d.error(this.$t("An error occurred. Please try again."),{position:"top-right",toastClassName:"Toastify__toast--delete"})}}finally{this.loading=!1}},async sendNewCode(){let e={email:this.email,error:this.error},o={BASE_URL:"/platform/",MODE:"production",DEV:!1,PROD:!0}.VITE_ROOT_API+"/userdata/sendNewCode";f.put(o,e).then(a=>{a.status==200?d.error(this.$t("Your code has already expired. A new code has been sent! Please wait for email."),{position:"top-right",toastClassName:"Toastify__toast--delete",autoClose:!1}):console.log("Unexpected response status:",a.status)}).catch(a=>{console.log(a)})},goBackToLogin(){this.$router.push({name:"login"})}}},R={class:"font-bold text-2xl text-red-800 tracking-widest"},v={class:"d-flex justify-center align-center"};function S(e,o,a,y,l,m){return C(),E(b,null,{default:s(()=>[t(n,null,{default:s(()=>[t(i,{cols:"12",class:"pb-0"},{default:s(()=>[h("h2",R,r(e.$t("Verify Your Email")),1)]),_:1})]),_:1}),t(n,null,{default:s(()=>[t(i,{cols:"12"},{default:s(()=>[c(r(e.$t("Please enter your email address and the confirmation code received in your email to verify your account:")),1)]),_:1})]),_:1}),t(x,{ref:"form",onSubmit:w(m.formSubmit,["prevent"])},{default:s(()=>[t(n,{justify:"center"},{default:s(()=>[t(i,{cols:"12",md:"10"},{default:s(()=>[t(p,null,{default:s(()=>[t(g,{modelValue:l.email,"onUpdate:modelValue":o[0]||(o[0]=u=>l.email=u),rules:l.emailRules,label:e.$t("Email:"),class:"mx-auto",style:{width:"100%"}},null,8,["modelValue","rules","label"])]),_:1})]),_:1})]),_:1}),t(n,{justify:"center"},{default:s(()=>[t(i,{cols:"12",md:"10"},{default:s(()=>[t(p,null,{default:s(()=>[t(g,{modelValue:l.code,"onUpdate:modelValue":o[1]||(o[1]=u=>l.code=u),rules:l.codeRules,label:e.$t("Confirmation Code:"),class:"mx-auto",style:{width:"100%"}},null,8,["modelValue","rules","label"]),h("div",v,[t(_,{onClick:m.goBackToLogin,class:"mt-3 mr-2"},{default:s(()=>[c(r(e.$t("Back to Login")),1)]),_:1},8,["onClick"]),t(_,{loading:l.loading,type:"submit",class:"mt-3 bg-red-700 text-white rounded"},{default:s(()=>[c(r(e.$t("Submit")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}const k=V(T,[["render",S]]);export{k as default};
