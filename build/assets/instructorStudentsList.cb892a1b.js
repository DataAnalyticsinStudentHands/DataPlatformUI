import{_ as x,u as m,a as p,i as v,o,c as u,g as l,t as f,b as i,w as c,r as g,al as C,s as D,h as y,l as I,I as k,B as w,v as L,am as P,M as N,F as R,x as U,q as V,z as M,af as b}from"./index.ff4761a7.js";const E={data(){return{studentListRaw:[],userListRaw:[],selectedStudents:[],showInactive:!1,searchStudent:"",hoverId:null,currentPage:1,itemsPerPage:10}},mounted(){m().startLoading();try{this.fetchStudentData(),this.fetchIncompletedStudentData(),window.scrollTo(0,0)}catch(t){this.handleError("Error:",t)}},watch:{searchStudent(t,e){t!==e&&(this.currentPage=1)},itemsPerPage(t,e){t!==e&&(this.currentPage=1)}},methods:{toggleShowInactive(){this.showInactive=!this.showInactive,this.currentPage=1},deactivateStudents(){let e=m().token;const a={userStatus:"Inactive"},h=this.selectedStudents.map(n=>{let r=`http://1529618mytest.us.reclaim.cloud/backend/userdata/userStatusUpdate/${n}`;return p.put(r,a,{headers:{token:e}})});Promise.all(h).then(()=>{const n=(this.selectedStudents.length===1?"Student":"Students")+" deactivated!",r=(s,d)=>{const _=Array.from(s);return _.forEach(S=>{this.selectedStudents.includes(S.userData._id)&&(S.userData.userStatus=d)}),_};this.studentListRaw=r(this.studentListRaw,"Inactive"),this.userListRaw=r(this.userListRaw,"Inactive"),this.selectedStudents=[],this.fetchStudentData(),this.fetchIncompletedStudentData(),v.error(n,{position:"top-right",toastClassName:"Toastify__toast--delete"})}).catch(n=>{this.handleError(n)})},activateStudents(){let e=m().token;const a={userStatus:"Active"},h=this.selectedStudents.map(n=>{let r=`http://1529618mytest.us.reclaim.cloud/backend/userdata/userStatusUpdate/${n}`;return p.put(r,a,{headers:{token:e}})});Promise.all(h).then(()=>{const n=(this.selectedStudents.length===1?"Student":"Students")+" activated!",r=(s,d)=>{const _=Array.from(s);return _.forEach(S=>{this.selectedStudents.includes(S.userData._id)&&(S.userData.userStatus=d)}),_};this.studentListRaw=r(this.studentListRaw,"Active"),this.userListRaw=r(this.userListRaw,"Active"),this.selectedStudents=[],this.fetchStudentData(),this.fetchIncompletedStudentData(),v.success(n,{position:"top-right",toastClassName:"Toastify__toast--create"})}).catch(n=>{this.handleError(n)})},majors(t){return t.length>0?t.join(", "):"None"},minors(t,e){let a=t.concat(e);return a.length>0?a.join(", "):"None"},listCheckedOptions(t){return t.filter(e=>e.checked===!0).map(e=>e.label).join(", ")},editStudent(t){this.$router.push({name:"instructorSpecificStudent",params:{userID:t}})},async fetchStudentData(){try{let e=m().token,a="http://1529618mytest.us.reclaim.cloud/backend/studentSideData/studentInformation/";const h=await p.get(a,{headers:{token:e}});this.studentListRaw=h.data.data}catch(t){this.handleError(t)}},async fetchIncompletedStudentData(){try{let e=m().token,a="http://1529618mytest.us.reclaim.cloud/backend/studentSideData/studentInformation/noEntryForms";const h=await p.get(a,{headers:{token:e}});this.userListRaw=h.data.userData}catch(t){this.handleError(t)}finally{m().stopLoading()}},updateSelectedStatus(t){t.checked&&t.userData.userStatus==="Active"&&(t.checked=!1)},normalizeData(t,e){if(e==="student")return{_id:t._id,userID:t.userData._id,studentInformation:{enrolledUHInfo:{uhEmail:t.studentInformation.enrolledUHInfo.uhEmail,majors:t.studentInformation.enrolledUHInfo.majors,honorsMinors:t.studentInformation.enrolledUHInfo.honorsMinors,otherMinors:t.studentInformation.enrolledUHInfo.otherMinors},pronouns:t.studentInformation.pronouns},userData:{_id:t.userData._id,firstName:t.userData.firstName,lastName:t.userData.lastName,email:t.userData.email,userStatus:t.userData.userStatus}};if(e==="user")return{_id:t._id,userID:t._id,studentInformation:{enrolledUHInfo:{uhEmail:"",majors:null,honorsMinors:null,otherMinors:null},pronouns:null},userData:{_id:t.userData._id,firstName:t.userData.firstName,lastName:t.userData.lastName,email:t.userData.email,userStatus:t.userData.userStatus}}}},computed:{filteredStudentData(){const t=this.searchStudent.toLowerCase();let e=this.studentListRaw;return t&&(e=this.studentListRaw.filter(a=>{var r;const h=`${a.userData.firstName} ${a.userData.lastName}`.toLowerCase(),n=((r=a.userData.email)==null?void 0:r.toLowerCase())||"";return h.includes(t)||n.includes(t)})),this.showInactive?e=e.filter(a=>a.userData.userStatus==="Inactive"):e=e.filter(a=>a.userData.userStatus==="Active"),e},filteredUserListRaw(){const t=this.searchStudent.toLowerCase();let e=this.userListRaw;return t&&(e=this.userListRaw.filter(a=>{var r;const h=`${a.userData.firstName} ${a.userData.lastName}`.toLowerCase(),n=((r=a.userData.email)==null?void 0:r.toLowerCase())||"";return h.includes(t)||n.includes(t)})),this.showInactive?e=e.filter(a=>a.userData.userStatus==="Inactive"):e=e.filter(a=>a.userData.userStatus==="Active"),e},mergedFilteredData(){const t=this.filteredStudentData.map(a=>({type:"student",data:this.normalizeData(a,"student")})),e=this.filteredUserListRaw.map(a=>({type:"user",data:this.normalizeData(a,"user")}));return t.concat(e)},paginatedMergedData(){const t=(this.currentPage-1)*this.itemsPerPage,e=this.currentPage*this.itemsPerPage;return this.mergedFilteredData.slice(t,e)},totalPaginationLength(){return Math.ceil(this.mergedFilteredData.length/this.itemsPerPage)},loading(){return m().loading}}},j={class:""},A=l("br",null,null,-1),H={class:"font-weight-black text-h5",style:{"text-align":"center"}},F={key:0,justify:"center",align:"center"},B={key:1},T={style:{display:"flex","justify-content":"center"}},z=l("thead",null,[l("tr",null,[l("th",{class:"text-left"}),l("th",{class:"text-left"},"Name"),l("th",{class:"text-left"},"Email"),l("th",{class:"text-left"},"Pronouns"),l("th",{class:"text-left"},"Major(s)"),l("th",{class:"text-left"},"Minor"),l("th",{class:"text-left"},"Expected Graduation Date")])],-1),G=["onMouseenter"],O={class:"text-left"},q=["value"],Y=["onClick"],J={key:1,class:"text-left"},K=["onClick"],Q={key:3,class:"text-left"},W=["onClick"],X={key:5},Z=["onClick"],$={key:7},tt=["onClick"],et={key:9},st=["onClick"],at={key:11};function nt(t,e,a,h,n,r){return o(),u("main",j,[A,l("p",H,f(n.showInactive?"Inactive Students":"Active Students"),1),i(g,{justify:"center",class:"pt-5"},{default:c(()=>[i(D,{cols:"12",class:"text-center"},{default:c(()=>[i(y,{onClick:r.toggleShowInactive},{default:c(()=>[I(f(n.showInactive?"Show Active Students":"Show Inactive Students"),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),i(g,{justify:"center"},{default:c(()=>[i(D,{cols:"12",class:"text-center"},{default:c(()=>[n.selectedStudents.length>0?(o(),k(y,{key:0,style:{"margin-right":"2rem"},onClick:r.deactivateStudents},{default:c(()=>[I(" Deactivate ")]),_:1},8,["onClick"])):w("",!0),n.selectedStudents.length>0?(o(),k(y,{key:1,onClick:r.activateStudents},{default:c(()=>[I(" Activate ")]),_:1},8,["onClick"])):w("",!0)]),_:1})]),_:1}),i(g,{class:"my-2"},{default:c(()=>[i(D,{cols:"12"},{default:c(()=>[i(L,{modelValue:n.searchStudent,"onUpdate:modelValue":e[0]||(e[0]=s=>n.searchStudent=s),placeholder:"Search by student name, email, major, minor, or graduation date",outlined:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),i(g,{class:"my-2"},{default:c(()=>[i(D,{cols:"12",md:"4"},{default:c(()=>[i(L,{modelValue:n.itemsPerPage,"onUpdate:modelValue":e[1]||(e[1]=s=>n.itemsPerPage=s),min:1,type:"number",label:"Number of Students Shown Per Page",outlined:"",style:{width:"70%"}},null,8,["modelValue"])]),_:1}),i(D,{cols:"12",md:"8",class:"text-center"},{default:c(()=>[i(P,{modelValue:n.currentPage,"onUpdate:modelValue":e[2]||(e[2]=s=>n.currentPage=s),length:r.totalPaginationLength,"total-visible":10},null,8,["modelValue","length"])]),_:1})]),_:1}),r.loading?(o(),u("div",F,[i(N,{indeterminate:""})])):(o(),u("div",B,[l("div",T,[i(C,{style:{width:"950%"}},{default:c(()=>[z,l("tbody",null,[(o(!0),u(R,null,U(r.paginatedMergedData,s=>(o(),u("tr",{key:s.type==="student"?s.data.userData._id:s.data._id,style:{cursor:"pointer"},class:V({hoverRow:n.hoverId===(s.type==="student"?s.data.userData._id:s.data._id)}),onMouseenter:d=>n.hoverId=s.type==="student"?s.data.userData._id:s.data._id,onMouseleave:e[4]||(e[4]=d=>n.hoverId=null)},[l("td",O,[M(l("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=d=>n.selectedStudents=d),value:s.type==="student"?s.data.userData._id:s.data._id,style:{outline:"2px solid #808080","margin-right":"10px"}},null,8,q),[[b,n.selectedStudents]])]),s.type==="student"?(o(),u("td",{key:0,onClick:d=>r.editStudent(s.data.userID),class:"text-left"},f(s.data.userData.firstName+" "+s.data.userData.lastName),9,Y)):(o(),u("td",J,f(s.data.userData.firstName)+" "+f(s.data.userData.lastName),1)),s.type==="student"?(o(),u("td",{key:2,onClick:d=>r.editStudent(s.data.userID),class:"text-left"},f(s.data.userData.email),9,K)):(o(),u("td",Q,f(s.data.userData.email),1)),s.type==="student"?(o(),u("td",{key:4,onClick:d=>r.editStudent(s.data.userID),class:"text-left"},f(r.listCheckedOptions(s.data.studentInformation.pronouns)),9,W)):(o(),u("td",X)),s.type==="student"?(o(),u("td",{key:6,onClick:d=>r.editStudent(s.data.userID),class:"text-left"},f(r.majors(s.data.studentInformation.enrolledUHInfo.majors)),9,Z)):(o(),u("td",$)),s.type==="student"?(o(),u("td",{key:8,onClick:d=>r.editStudent(s.data.userID),class:"text-left"},f(r.minors(s.data.studentInformation.enrolledUHInfo.otherMinors,s.data.studentInformation.enrolledUHInfo.honorsMinors)),9,tt)):(o(),u("td",et)),s.type==="student"?(o(),u("td",{key:10,onClick:d=>r.editStudent(s.data.userID),class:"text-left"},f(s.data.studentInformation.enrolledUHInfo.expectedGraduationYear),9,st)):(o(),u("td",at))],42,G))),128))])]),_:1})])]))])}const ot=x(E,[["render",nt]]);export{ot as default};
